"use strict";function switchOptionsView(a){var b=a.target.closest(".options-menu-link"),c=b.getAttribute("data-title"),d="#"+b.getAttribute("data-color"),e=document.querySelectorAll(".options-window"),f=document.querySelectorAll(".options-menu-link");document.querySelector(".options-menu").classList.remove("expanded");var g=!0,h=!1,i=void 0;try{for(var j,k=e[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){var l=j.value;l.style.display="none"}}catch(a){h=!0,i=a}finally{try{!g&&k.return&&k.return()}finally{if(h)throw i}}document.querySelector("."+c).style.display="block";var m=!0,n=!1,o=void 0;try{for(var p,q=f[Symbol.iterator]();!(m=(p=q.next()).done);m=!0){var r=p.value;r.classList.remove("active")}}catch(a){n=!0,o=a}finally{try{!m&&q.return&&q.return()}finally{if(n)throw o}}b.classList.add("active"),document.querySelector(".options-window-title").style.backgroundColor=d,document.querySelector(".options-window-title-text").innerHTML=c,location.hash="#"+c.toLowerCase()}function saveStatusOptions(){chrome.storage.sync.set({GC_status:document.querySelector("input[type=checkbox][name=GC_status]").checked,GM_status:document.querySelector("input[type=checkbox][name=GM_status]").checked,CP_status:document.querySelector("input[type=checkbox][name=CP_status]").checked,SB_status:document.querySelector("input[type=checkbox][name=SB_status]").checked,SAB_status:document.querySelector("input[type=checkbox][name=SAB_status]").checked,DN_status:document.querySelector("input[type=checkbox][name=DN_status]").checked,HN_status:document.querySelector("input[type=checkbox][name=HN_status]").checked,GH_status:document.querySelector("input[type=checkbox][name=GH_status]").checked,PH_status:document.querySelector("input[type=checkbox][name=PH_status]").checked,DR_status:document.querySelector("input[type=checkbox][name=DR_status]").checked,RD_status:document.querySelector("input[type=checkbox][name=RD_status]").checked,NG_status:document.querySelector("input[type=checkbox][name=NG_status]").checked,SO_status:document.querySelector("input[type=checkbox][name=SO_status]").checked},function(){refreshBackgroundServiceData().then(function(a){a.createAlarms()})})}function saveOptions(){var a=[],b=document.querySelectorAll(".calendar-checkbox.checked"),c=!0,d=!1,e=void 0;try{for(var f,g=b[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;a.push(h.getAttribute("data-id"))}}catch(a){d=!0,e=a}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}CP_address=formatUrl("CP-address"),SB_address=formatUrl("SB-address"),SAB_address=formatUrl("SAB-address"),NG_address=formatUrl("NG-address"),SO_address=formatUrl("SO-address"),chrome.storage.sync.set({calendars:a,GC_days:document.querySelector("#GC-days").value,GC_width:document.querySelector("#GC-width").value,GC_refresh:document.querySelector("#GC-refresh").value,GM_width:document.querySelector("#GM-width").value,GM_refresh:document.querySelector("#GM-refresh").value,CP_address:CP_address,CP_port:document.querySelector("#CP-port").value,CP_key:document.querySelector("#CP-key").value,CP_width:document.querySelector("#CP-width").value,CP_refresh:document.querySelector("#CP-refresh").value,SB_address:SB_address,SB_port:document.querySelector("#SB-port").value,SB_key:document.querySelector("#SB-key").value,SB_width:document.querySelector("#SB-width").value,SB_refresh:document.querySelector("#SB-refresh").value,SAB_address:SAB_address,SAB_port:document.querySelector("#SAB-port").value,SAB_key:document.querySelector("#SAB-key").value,SAB_history:document.querySelector("#SAB-history").value,SAB_width:document.querySelector("#SAB-width").value,SABQ_refresh:document.querySelector("#SABQ-refresh").value,SABH_refresh:document.querySelector("#SABH-refresh").value,DN_width:document.querySelector("#DN-width").value,DN_refresh:document.querySelector("#DN-refresh").value,HN_width:document.querySelector("#HN-width").value,HN_refresh:document.querySelector("#HN-refresh").value,GH_width:document.querySelector("#GH-width").value,GH_refresh:document.querySelector("#GH-refresh").value,PH_width:document.querySelector("#PH-width").value,PH_refresh:document.querySelector("#PH-refresh").value,DR_small_images:document.querySelector(".dr-small-images-checkbox").classList.contains("checked"),DR_gifs:document.querySelector(".dr-gif-checkbox").classList.contains("checked"),DR_width:document.querySelector("#DR-width").value,DR_refresh:document.querySelector("#DR-refresh").value,RD_subreddit:document.querySelector("#RD-subreddit").value,RD_sorting:document.querySelector("#RD-sorting").value,RD_width:document.querySelector("#RD-width").value,RD_refresh:document.querySelector("#RD-refresh").value,NG_address:NG_address,NG_port:document.querySelector("#NG-port").value,NG_width:document.querySelector("#NG-width").value,NGQ_refresh:document.querySelector("#NGQ-refresh").value,NGH_refresh:document.querySelector("#NGH-refresh").value,NGH_length:document.querySelector("#NGH-length").value,NG_username:document.querySelector("#NG-username").value,NG_password:document.querySelector("#NG-password").value,SO_address:SO_address,SO_port:document.querySelector("#SO-port").value,SO_key:document.querySelector("#SO-key").value,SO_width:document.querySelector("#SO-width").value,SO_refresh:document.querySelector("#SO-refresh").value},function(){chrome.runtime.getBackgroundPage(function(a){a.refreshServiceData(),a.createAlarms()});var a=document.querySelector(".status");a.innerHTML="Options saved.",a.style.bottom="16px",setTimeout(function(){a.style.bottom="-48px",a.innerHTLM=""},1e3)})}function restore_options(){serviceData.GC.status&&document.querySelector("input[type=checkbox][name=GC_status]").setAttribute("checked","true"),document.querySelector("#GC-days").value=serviceData.GC.days,document.querySelector("#GC-width").value=serviceData.GC.panelWidth,document.querySelector("#GC-refresh").value=serviceData.GC.refresh,serviceData.GM.status&&document.querySelector("input[type=checkbox][name=GM_status]").setAttribute("checked","true"),document.querySelector("#GM-width").value=serviceData.GM.panelWidth,document.querySelector("#GM-refresh").value=serviceData.GM.refresh,serviceData.CP.status&&document.querySelector("input[type=checkbox][name=CP_status]").setAttribute("checked","true"),document.querySelector("#CP-address").value=serviceData.CP.address,document.querySelector("#CP-port").value=serviceData.CP.port,document.querySelector("#CP-key").value=serviceData.CP.key,document.querySelector("#CP-width").value=serviceData.CP.panelWidth,document.querySelector("#CP-refresh").value=serviceData.CP.refresh,serviceData.SB.status&&document.querySelector("input[type=checkbox][name=SB_status]").setAttribute("checked","true"),document.querySelector("#SB-address").value=serviceData.SB.address,document.querySelector("#SB-port").value=serviceData.SB.port,document.querySelector("#SB-key").value=serviceData.SB.key,document.querySelector("#SB-width").value=serviceData.SB.panelWidth,document.querySelector("#SB-refresh").value=serviceData.SB.refresh,serviceData.SAB.status&&document.querySelector("input[type=checkbox][name=SAB_status]").setAttribute("checked","true"),document.querySelector("#SAB-address").value=serviceData.SAB.address,document.querySelector("#SAB-port").value=serviceData.SAB.port,document.querySelector("#SAB-key").value=serviceData.SAB.key,document.querySelector("#SAB-history").value=serviceData.SAB.history.length,document.querySelector("#SAB-width").value=serviceData.SAB.panelWidth,document.querySelector("#SABQ-refresh").value=serviceData.SAB.queue.refresh,document.querySelector("#SABH-refresh").value=serviceData.SAB.history.refresh,serviceData.DN.status&&document.querySelector("input[type=checkbox][name=DN_status]").setAttribute("checked","true"),document.querySelector("#DN-width").value=serviceData.DN.panelWidth,document.querySelector("#DN-refresh").value=serviceData.DN.refresh,serviceData.HN.status&&document.querySelector("input[type=checkbox][name=HN_status]").setAttribute("checked","true"),document.querySelector("#HN-width").value=serviceData.HN.panelWidth,document.querySelector("#HN-refresh").value=serviceData.HN.refresh,serviceData.GH.status&&document.querySelector("input[type=checkbox][name=GH_status]").setAttribute("checked","true"),document.querySelector("#GH-width").value=serviceData.GH.panelWidth,document.querySelector("#GH-refresh").value=serviceData.GH.refresh,serviceData.PH.status&&document.querySelector("input[type=checkbox][name=PH_status]").setAttribute("checked","true"),document.querySelector("#PH-width").value=serviceData.PH.panelWidth,document.querySelector("#PH-refresh").value=serviceData.PH.refresh,serviceData.DR.status&&document.querySelector("input[type=checkbox][name=DR_status]").setAttribute("checked","true"),serviceData.DR.smallImages&&document.querySelector(".dr-small-images-checkbox").classList.add("checked"),serviceData.DR.gifs&&document.querySelector(".dr-gif-checkbox").classList.add("checked"),document.querySelector("#DR-width").value=serviceData.DR.panelWidth,document.querySelector("#DR-refresh").value=serviceData.DR.refresh,serviceData.RD.status&&document.querySelector("input[type=checkbox][name=RD_status]").setAttribute("checked","true"),document.querySelector("#RD-subreddit").value=serviceData.RD.subreddit,document.querySelector("#RD-sorting").value=serviceData.RD.sorting,document.querySelector("#RD-width").value=serviceData.RD.panelWidth,document.querySelector("#RD-refresh").value=serviceData.RD.refresh,serviceData.NG.status&&document.querySelector("input[type=checkbox][name=NG_status]").setAttribute("checked","true"),document.querySelector("#NG-address").value=serviceData.NG.address,document.querySelector("#NG-port").value=serviceData.NG.port,document.querySelector("#NG-width").value=serviceData.NG.panelWidth,document.querySelector("#NGQ-refresh").value=serviceData.NG.queue.refresh,document.querySelector("#NGH-refresh").value=serviceData.NG.history.refresh,document.querySelector("#NGH-length").value=serviceData.NG.history.length,document.querySelector("#NG-username").value=serviceData.NG.username,document.querySelector("#NG-password").value=serviceData.NG.password,serviceData.SO.status&&document.querySelector("input[type=checkbox][name=SO_status]").setAttribute("checked","true"),document.querySelector("#SO-address").value=serviceData.SO.address,document.querySelector("#SO-port").value=serviceData.SO.port,document.querySelector("#SO-key").value=serviceData.SO.key,document.querySelector("#SO-width").value=serviceData.SO.panelWidth,document.querySelector("#SO-refresh").value=serviceData.SO.refresh}function formatUrl(a){var b=document.querySelector("#"+a);return"https://"==b.value.slice(0,8)||"http://"==b.value.slice(0,7)?b.value:"http://"+b.value}serviceDataRefreshDone.then(function(){restore_options(),dragula([document.getElementById("services-menu")],{moves:function(a,b,c){return"drag-handle"===c.className},direction:"vertical"}).on("dragend",function(a,b,c){var d=[],e=document.querySelectorAll(".options-menu-link"),f=!0,g=!1,h=void 0;try{for(var i,j=e[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var a=i.value,k=a.getAttribute("data-service-id");k&&d.push(k)}}catch(a){g=!0,h=a}finally{try{!f&&j.return&&j.return()}finally{if(g)throw h}}localStorage.setItem("serviceOrder",d)});var a=localStorage.getItem("serviceOrder");if(a){var a=a.split(","),b=document.querySelector("#services-menu");a.forEach(function(a,c){serviceHTML=b.querySelector('[data-service-id="'+a+'"]'),serviceHTML&&b.appendChild(serviceHTML)})}document.querySelector(".options-menu-icon").addEventListener("click",function(){var a=document.querySelector(".options-menu");a.classList.contains("expanded")?a.classList.remove("expanded"):a.classList.add("expanded")});var c=document.querySelectorAll(".options-menu-link"),d=!0,e=!1,f=void 0;try{for(var g,h=c[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value;i.addEventListener("click",switchOptionsView)}}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}if(location.hash){var j=location.hash.split("#")[1].toLowerCase();document.querySelector('.options-menu-link[data-lowTitle="'+j+'"]').click()}document.querySelector(".calendar-loading").innerHTML=serviceData.spinner,chrome.identity.getAuthToken({interactive:!0},function(a){var b="https://www.googleapis.com/calendar/v3/users/me/calendarList?oauth_token="+a;ajax("GET",b).then(function(a){document.querySelector(".calendar-loading").style.display="none";var b=serviceData.GC.calendars;a.items.forEach(function(a){b.indexOf(a.id)>-1?document.querySelector(".calendar-select-container").insertAdjacentHTML("beforeend","<div class='calendar-checkbox checkbox-container checked' data-id="+a.id+"><div class='checkbox'><div class='checkbox-mark'></div></div><span class='checkbox-label'>"+a.summary+"</span></div>"):document.querySelector(".calendar-select-container").insertAdjacentHTML("beforeend","<div class='calendar-checkbox checkbox-container' data-id="+a.id+"><div class='checkbox'><div class='checkbox-mark'></div></div><span class='checkbox-label'>"+a.summary+"</span></div>")})},function(a){console.log(a),document.querySelector(".calendar-loading").style.display="none",document.querySelector(".calendar-select-container").insertAdjacentHTML("beforeend",'<div><div class="error-icon"></div><p>Failed to connect to Google Calendar check your connection and refresh.</p></div>')})});var k=document.querySelectorAll("input, .checkbox-container"),l=!0,m=!1,n=void 0;try{for(var o,p=k[Symbol.iterator]();!(l=(o=p.next()).done);l=!0){var q=o.value;q.addEventListener("change",saveOptions)}}catch(a){m=!0,n=a}finally{try{!l&&p.return&&p.return()}finally{if(m)throw n}}var r=document.querySelectorAll(".switch input[type=checkbox]"),s=!0,t=!1,u=void 0;try{for(var v,w=r[Symbol.iterator]();!(s=(v=w.next()).done);s=!0){var x=v.value;x.addEventListener("change",saveStatusOptions)}}catch(a){t=!0,u=a}finally{try{!s&&w.return&&w.return()}finally{if(t)throw u}}});