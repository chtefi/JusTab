"use strict";function getSickBeardData(a){var b=serviceData.SB.apiUrl,c="?cmd=future&sort=date&type=today|missed|soon|later";ajax("GET",b+c).then(function(b){localStorage.setItem("Sickbeard_error",!1),serviceData.SB.error=!1,localStorage.setItem("Sickbeard",JSON.stringify(b)),serviceData.SB.JSON=b,sbHTML(),a&&a()},function(){localStorage.setItem("Sickbeard_error",!0),serviceData.SB.error=!0,a&&a()})}function sbHTML(){serviceData.SB.apiUrl;if(serviceData.SB.JSON){if(data=serviceData.SB.JSON,data.data.missed.length>0){var a="<h2>Missed</h2>";listSeries(data.data.missed,a,"SickbeardMissedHTML","MissedHTML")}else localStorage.removeItem("SickbeardMissedHTML"),delete serviceData.SB.MissedHTML;if(data.data.today.length>0){var b="<h2>Today</h2>";listSeries(data.data.today,b,"SickbeardTodayHTML","TodayHTML")}else localStorage.removeItem("SickbeardTodayHTML"),delete serviceData.SB.TodayHTML;if(data.data.soon.length>0){var c="<h2>Soon</h2>";listSeries(data.data.soon,c,"SickbeardSoonHTML","SoonHTML")}else localStorage.removeItem("SickbeardSoonHTML"),delete serviceData.SB.SoonHTML;if(data.data.later.length>0){var d="<h2>Later</h2>";listSeries(data.data.later,d,"SickbeardLaterHTML","LaterHTML")}else localStorage.removeItem("SickbeardLaterHTML"),delete serviceData.SB.LaterHTML}}function listSeries(a,b,c,d){a.forEach(function(a){var c,d=a.tvdbid,e=a.season,f=a.episode,g=a.airdate,h=a.show_name,i="http://thetvdb.com/banners/posters/"+d+"-1.jpg";c=moment(g).isSame(moment(),"day")?"Today":moment(g).isSame(moment().add(1,"day"),"day")?"Tomorrow":moment(g).isSame(moment().subtract(1,"day"),"day")?"Yesterday":moment(g).year()>moment().year()?moment(g).format("MMM D, YYYY"):moment(g).format("MMM D");var j=" S"+(e<10?"0":"")+e+"E"+(f<10?"0":"")+f;b+='<div class="sb-item core-item"><div class="sb-poster-container"><img class="sb-poster" src="img/poster_fallback.png" data-echo="'+i+'"></div><div class="core-item-content">'+htmlEncode(h+j)+'</div><div class="core-item-icon"></div></div><div class="sb-collapse core-collapse"><div class="sb-collapse-date">'+htmlEncode(c)+'</div><div class="sb-collapse-buttons"><div class="icon-button search-icon sb-search-episode waves-effect" data-tvdbid="'+d+'" data-season="'+e+'" data-episode="'+f+'"></div><a class="sb-tvdb-link" href="http://thetvdb.com/?tab=series&id='+d+'" target="_blank"><div class="icon-button info-icon sb-tvdb-link-icon waves-effect"></div></a><div class="icon-button done-icon sb-mark-episode waves-effect" data-tvdbid="'+d+'" data-season="'+e+'" data-episode="'+f+'"></div></div></div>'}),localStorage.setItem(c,b),serviceData.SB[c]=b}